package net.supercraftalex.liquido.modules.impl.Exploits;

import org.lwjgl.input.Keyboard;

import com.darkmagician6.eventapi.EventManager;
import com.darkmagician6.eventapi.EventTarget;

import net.minecraft.block.BlockAir;
import net.minecraft.init.Blocks;
import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraft.network.play.client.C07PacketPlayerDigging;
import net.minecraft.network.play.client.C07PacketPlayerDigging.Action;
import net.minecraft.util.BlockPos;
import net.minecraft.util.EnumFacing;
import net.supercraftalex.liquido.Booleans;
import net.supercraftalex.liquido.events.EventUpdate;
import net.supercraftalex.liquido.modules.Category;
import net.supercraftalex.liquido.modules.Config;
import net.supercraftalex.liquido.modules.ConfigMode;
import net.supercraftalex.liquido.modules.Module;
import net.supercraftalex.liquido.utils.PacketUtils;

public class InstantBreak extends Module{

	public InstantBreak() {
		super("instantbreak", "InstantBreak", Keyboard.KEY_NONE, Category.EXPLOITS);
		addConfig(new Config("mode", true ,new ConfigMode()));
		getConfigByName("mode").getConfigMode().addMode("vanilla");
		getConfigByName("mode").getConfigMode().addMode("ncp");
	}

	@EventTarget
	public void onUpdate(EventUpdate event) {
		if(!Booleans.hacking_enabled) {return;}
		BlockPos var1 = mc.objectMouseOver.getBlockPos();

		if (mc.theWorld.getBlockState(var1).getBlock()== Blocks.air) {
			return;
		}
		if (mc.playerController.isHittingBlock) {
			if (getConfigByName("mode").getConfigMode().getValue().equals("vanilla") && mc.gameSettings.keyBindAttack.isKeyDown())
				PacketUtils.sendPacket(new C07PacketPlayerDigging(Action.STOP_DESTROY_BLOCK,mc.objectMouseOver.getBlockPos(), EnumFacing.getHorizontal(-1)));
			else {
				PacketUtils.sendPacket(new C07PacketPlayerDigging(Action.START_DESTROY_BLOCK,mc.objectMouseOver.getBlockPos(), EnumFacing.getHorizontal(-1)));
				PacketUtils.sendPacket(new C07PacketPlayerDigging(Action.STOP_DESTROY_BLOCK,mc.objectMouseOver.getBlockPos(), EnumFacing.getHorizontal(-1)));
			}
		}
	}
	
	@Override
	public void onEnable() {
		EventManager.register(this);
	}
	
	@Override
	public void onDisable() {
		EventManager.unregister(this);
	}
	
}